{% extends "dashboard_base.html" %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="custom-card text-center">
            <div class="map-container" style="background-color: white; overflow: hidden;">
                <img src="{{ url_for('static', filename='denah_test.png') }}" 
                     alt="Denah Lokasi" 
                     style="height: 100%; width: auto; object-fit: contain;">
            </div>
            <h5 class="mt-2">Denah</h5>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="custom-card h-100">
            <form method="POST" action="{{ url_for('views.send_page') }}">
                <div class="mb-3 row">
                    <label class="col-sm-5 col-form-label fw-bold">Pilihan Pengiriman:</label>
                    <div class="col-sm-7">
                        <input type="text" class="form-control" name="pilihan" 
                               placeholder="Kode Ruang (Cth: 11A)" maxlength="3" required>
                    </div>
                </div>
                <div class="mb-3 row">
                    <label class="col-sm-5 col-form-label fw-bold">Nama:</label>
                    <div class="col-sm-7">
                        <input type="text" class="form-control" name="nama" placeholder="Nama Pengirim" maxlength="10" required>
                    </div>
                </div>
                
                <div class="d-flex justify-content-end mt-4">
                     <button type="submit" class="btn btn-primary px-4">Kalkulasi & Kirim</button>
                </div>
            </form>
        </div>
    </div>

    <div class="col-md-6">
        <div class="custom-card h-100 d-flex flex-column"> <div class="mt-3">
                <h6 class="fw-bold">Kalkulasi Rute:</h6>
                
                {% if status_rute %}
                    <h4 class="{{ warna_status }} fw-bold mb-3">{{ status_rute }}</h4>
                    
                    <p class="text-muted mb-1" style="font-size: 0.9rem;">Jalur Node:</p>
                    <div class="p-2 bg-light border rounded mb-3">
                        <small class="fw-bold text-dark">{{ hasil_rute }}</small>
                    </div>

                    {% if instruksi %}
                    <p class="text-muted mb-1" style="font-size: 0.9rem;">Instruksi Robot:</p>
                    <div class="list-group">
                        {% for step in instruksi %}
                            <div class="list-group-item list-group-item-action py-2">
                                {% if 'Kanan' in step %}
                                    ‚Ü™Ô∏è 
                                {% elif 'Kiri' in step %}
                                    ‚Ü©Ô∏è 
                                {% elif 'Lurus' in step or 'Maju' in step %}
                                    ‚¨ÜÔ∏è 
                                {% elif 'Sampai' in step %}
                                    üèÅ 
                                {% else %}
                                    üîπ
                                {% endif %}
                                <span class="ms-2 fw-bold" style="font-size: 0.9rem;">{{ step }}</span>
                            </div>
                        {% endfor %}
                    </div>
                    {% endif %}
                    
                {% else %}
                    <h4 class="text-secondary fw-bold">MENUNGGU INPUT...</h4>
                    <p class="text-muted">Silakan masukkan kode ruangan pada form di samping.</p>
                {% endif %}
                
            </div>
        </div>
    </div>
</div>
{% endblock %}